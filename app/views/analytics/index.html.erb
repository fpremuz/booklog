<h1 class="text-2xl font-bold mb-4">Your Book Analytics</h1>

<div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
  <div class="p-4 bg-white shadow rounded">
    <h2 class="text-sm text-gray-600">Books Read This Year</h2>
    <p class="text-2xl font-bold"><%= @books_read_this_year %></p>
  </div>

  <div class="p-4 bg-white shadow rounded">
    <h2 class="text-sm text-gray-600">Currently Reading</h2>
    <p class="text-2xl font-bold"><%= @currently_reading %></p>
  </div>

  <div class="p-4 bg-white shadow rounded">
    <h2 class="text-sm text-gray-600">Average Rating</h2>
    <p class="text-2xl font-bold"><%= @average_rating %></p>
  </div>

  <div class="p-4 bg-white shadow rounded">
    <h2 class="text-sm text-gray-600">Total Pages Read</h2>
    <p class="text-2xl font-bold"><%= @total_pages_read %></p>
  </div>

  <%= line_chart @books_per_month, library: {
    plugins: {
      title: {
        display: true,
        text: "Books Read Per Month"
      }
    }
  } %>

  <%= column_chart({
    "To Read" => Book.where(status: "to_read").count,
    "Reading" => Book.where(status: "reading").count,
    "Read" => Book.where(status: "read").count
  }, library: {
    plugins: {
      title: {
        display: true,
        text: "Books by Reading Status"
      }
    }
  }) %>

  <%= pie_chart(
    (1..5).map { |r| [ "#{r} stars", Book.where(rating: r).count ] }.to_h,
    library: {
      plugins: {
        title: {
          display: true,
          text: "Ratings Distribution"
        }
      }
    }
  ) %>

  <%= bar_chart(
    Book.where(status: "read").limit(5).pluck(:title, :pages_read).to_h,
    library: {
      plugins: {
        title: {
          display: true,
          text: "Pages Read by Book (Top 5)"
        }
      }
    }
  ) %>
</div>